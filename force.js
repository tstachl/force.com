Force={version:"0.1.0",versionDetail:{major:0,minor:1,patch:0},session:null,ready:Ext.onReady,formatDate:Ext.util.Format.date,serverDateFormat:"Y-m-d\\TH:i:s.uO",setSession:function(c){this.session=c;Ext.Ajax.defaultHeaders={Authorization:"OAuth "+c,"Content-Type":"application/json"};Ext.Ajax.disableCaching=!1}};Ext.ns("Force.data","Force.grid");Force.data.Writer=Ext.extend(Ext.data.JsonWriter,{render:function(c,h,e){typeof e.Id!="undefined"&&delete e.Id;c.jsonData=e}});
Force.data.Proxy=Ext.extend(Ext.data.HttpProxy,{});
Force.data.Store=Ext.extend(Ext.data.JsonStore,{showAlert:!0,colModel:null,clause:null,constructor:function(c){if(Ext.isDefined(c.colModel))c.fields=[],Ext.each(c.colModel.columns,function(h){c.fields.push(h.dataIndex)});Ext.apply(c,{restful:!0,root:"records",idProperty:"Id",successProperty:"done",totalProperty:"totalSize",writer:new Force.data.Writer,proxy:new Force.data.Proxy({method:"GET",url:"/services/data/v20.0/query.json",api:{create:{url:"/services/data/v20.0/sobjects/"+c.table+".json",method:"PATCH"},
update:{url:"/services/data/v20.0/sobjects/"+c.table+".json",method:"PATCH"},destroy:{url:"/services/data/v20.0/sobjects/"+c.table+".json",method:"DELETE"}}})});Force.data.Store.superclass.constructor.call(this,c);this.addListener("exception",this.exceptionThrown,this)},load:function(c){c=Ext.apply({},c);this.storeOptions(c);c.params=Ext.apply({},c.params);var h="";this.sortInfo&&this.remoteSort&&(h=" ORDER BY "+this.sortInfo.field,h+=" "+this.sortInfo.direction);Ext.apply(c.params,{q:this.getQuery()+
h});try{return this.execute("read",null,c)}catch(e){return this.handleException(e),!1}},getQuery:function(){var c="SELECT ";Ext.each(this.fields.keys,function(h,e,a){c+=h+(e==a.length-1?" ":", ")});c+="FROM "+this.table;return this.clause?c+" "+this.clause:c},execute:function(c,h,e,a){if(!Ext.data.Api.isAction(c))throw new Ext.data.Api.Error("execute",c);e=Ext.applyIf(e||{},{params:{}});a!==void 0&&this.addToBatch(a);var n=!0;c==="read"?(n=this.fireEvent("beforeload",this,e),Ext.applyIf(e.params,
this.baseParams)):(this.writer.listful===!0&&this.restful!==!0?h=Ext.isArray(h)?h:[h]:Ext.isArray(h)&&h.length==1&&(h=h.shift()),(n=this.fireEvent("beforewrite",this,c,h,e))!==!1&&this.writer.apply(e.params,this.baseParams,c,h));if(n!==!1){if(this.writer&&this.proxy.url&&!this.proxy.restful&&!Ext.data.Api.hasUniqueUrl(this.proxy,c))e.params.xaction=c;this.proxy.request(Ext.data.Api.actions[c],h,e.params,this.reader,this.createCallback(c,h,a),this,e)}return n},exceptionThrown:function(c,h,e,a,n){this.showAlert&&
(c=Ext.decode(n.responseText),Ext.Msg.alert(n.status+" "+n.statusText,c[0].message))},getColModel:function(){if(this.colModel)return new Ext.grid.ColumnModel(this.colModel);return null}});
Ext.override(Ext.grid.GridPanel,{constructor:function(c){this.createStore(c);Ext.grid.GridPanel.superclass.constructor.call(this,c)},createStore:function(c){console.log("Hello");if(!Ext.isDefined(c.store)&&Ext.isDefined(c.colModel)&&Ext.isDefined(c.colModel.columns)&&Ext.isDefined(c.table)){var h=[];Ext.each(c.colModel.columns,function(c){h.push(c.dataIndex)});c.store=new Force.data.Store({autoDestroy:!0,table:c.table,fields:h});c.store.load();c.colModel=new Ext.grid.ColumnModel(c.colModel)}}});
